---
categories: [SWACADEMY]
---

# AWS Hands-on

## Tag

- 리소스 관리를 위해 key-value 형식의 tag 부여
- aws는 모든 리소스에 대해 tag를 부여 가능(리소스 Name의 경우에도 Tag의 한 종류)
- 소유자, 작업자, 프로젝트 등 관리하고자 하는 분류 기준으로 Tag 부여
- 리소스 생성 시 입력하거나, 리소스 생성 후 변경
- 태그의 Key, Value를 기준으로 자동화 정책을 생성할 수 있으므로, 관리 관점에서 매우 유용

![Tag](/assets/images/2023/03/24/img.png)

## IAM(Identity and Access Management)

- 정책과 권한 그룹을 통해 RBAC 기반의 액세스 제어
- AWS 제공 정책 또는 사용자 정의 정책을 IAM Group에 해당
- IAM User(또는 역할)에 권한 정책을 직접 적용하지 않고, IAM User(또는 역할)를 IAM Group에 맵핑하여 관리
- AWS 공식 가이드 : https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/introduction.htm

![IAM](/assets/images/2023/03/24/img_1.png)

## 실습

### 목표 설계도

![img_5.png](img_5.png)

### VPC 생성

![img.png](img.png)

![img_1.png](img_1.png)

![img_2.png](img_2.png)

### Subnet 생성

![img_3.png](img_3.png)

- VPC는 자기 이름으로 검색
- Subnet 이름

|          |            AZ-c            |            AZ-a            |
|:--------:|:--------------------------:|:--------------------------:|
|   외부망    | dongjoon-ext-c-sbn-01 / 0  | dongjoon-ext-a-sbn-01 / 1  |
| 내부망(FE)  | dongjoon-int1-c-sbn-01 / 2 | dongjoon-int1-a-sbn-01 / 3 |
| 내부망(BE)  | dongjoon-int2-c-sbn-01 / 4 | dongjoon-int2-a-sbn-01 / 5 |
| 내부망(DB)  | dongjoon-data-c-sbn-01 / 6 | dongjoon-data-a-sbn-01 / 7 |

- 가용영역 쓰는 순서는 c - a - b - d 이다.
- CIDR은 `10.10.0.0/24` ~ `10.10.7.0/24`까지
- 태그에 `Owner` 반드시 붙일 것!

![img_4.png](img_4.png)

![img_7.png](img_7.png)

![img_6.png](img_6.png)

![img_8.png](img_8.png)

![img_9.png](img_9.png)

int2-a가 빠짐

![img_10.png](img_10.png)

![img_11.png](img_11.png)

생성 확인

![img_12.png](img_12.png)

### IGW 생성

![img_13.png](img_13.png)

![img_14.png](img_14.png)

![img_15.png](img_15.png)

![img_16.png](img_16.png)

### Routing Table 생성

![img_17.png](img_17.png)

VPC를 생성하면 기본적으로 주는 라우팅 테이블이 존재한다.(위 그림)

![img_20.png](img_20.png)

해당 라우팅 테이블에 이름과 소유자 태그를 설정해준다.

(라우팅 테이블을 서브넷마다 적용할 수 있다. 라우팅 테이블은 티어마다 설정해주는 것이 좋다.)

#### 외부용 라우팅 테이블

![img_18.png](img_18.png)

생성 후 서브넷을 연결 해준다.

![img_22.png](img_22.png)

![img_23.png](img_23.png)

![img_24.png](img_24.png)

![img_27.png](img_27.png)

#### 내부용 라우팅 테이블

![img_19.png](img_19.png)

생성 후 서브넷을 연결 해준다.

![img_25.png](img_25.png)

![img_26.png](img_26.png)

#### 생성 및 서브넷 연결 확인

![img_21.png](img_21.png)

#### 인터넷 게이트웨이 연결

![img_28.png](img_28.png)

![img_29.png](img_29.png)

인터넷 게이트웨이는 inbound / outbound 모두 받아준다.

### NAT Gateway 생성

![img_30.png](img_30.png)

![img_31.png](img_31.png)

NAT 게이트웨이는 내부망에서 나가는 outbound는 허용 O, 외부망에서 들어오는 inbound는 허용 X

#### 탄력적 IP 주소 이름 편집

![img_32.png](img_32.png)

![img_33.png](img_33.png)

#### 내부용 라우팅 테이블에 NAT Gateway 연결

![img_34.png](img_34.png)

![img_35.png](img_35.png)

### SG(Security Group) 생성

![img_36.png](img_36.png)

![img_37.png](img_37.png)

### Bastion EC2 생성

![img_38.png](img_38.png)

![img_39.png](img_39.png)

![img_40.png](img_40.png)

이름은 `dongjoon-bastion-ec2-01`

![img_41.png](img_41.png)

서버는 Ubuntu 20.04 LTS

![img_42.png](img_42.png)

인스턴스 유형은 제일 싼 t2.nano

![img_43.png](img_43.png)

![img_44.png](img_44.png)

![img_45.png](img_45.png)

인스턴스 시작

![img_46.png](img_46.png)
서버 생성 및 구동 및 IP 주소 확인

![img_47.png](img_47.png)

mobaxterm 구동

![img_48.png](img_48.png)

저장해뒀던 pem키를 이용하여 접속 username은 ubuntu

![img_49.png](img_49.png)

접속 완료

**만약 접속 안될 시**

![img_50.png](img_50.png)

네이버에서 내 아이피 찾아서 bastion 보안 그룹의 inbound 규칙에 찾은 IP 입력 후 다시 접속하면 됨.

### Bastion 서버 설정

sshd config 파일 열기

![img_51.png](img_51.png)

passwordauthentication yes로 변경

![img_52.png](img_52.png)

sshd 재시작

![img_53.png](img_53.png)

ubuntu 계정 비밀번호 설정

![img_54.png](img_54.png)

pem키를 bastion 서버에 전송

`scp .\test1.pem ubuntu@52.79.235.154:/home/ubuntu`

![img_55.png](img_55.png)

전송 받은거 확인

![img_56.png](img_56.png)

### 이중화 서버 생성



### 이중화 서버 설정

### ELB의 구조

![ELB1](/assets/images/2023/03/24/img_2.png)

### ELB의 종류와 기능

![ELB2](/assets/images/2023/03/24/img_3.png)

### Target Group 생성

### ALB 생성
